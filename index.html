<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.17" />

  <title>WRISH</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  
  <link rel="alternate" type="application/rss+xml" title="WRISH" href="http://www.wrish.com/index.xml" />
  

  
  <link rel="stylesheet" href="http://www.wrish.com/css/atom-one-light.css">
  <script src="http://www.wrish.com/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://www.wrish.com/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/"><img src='/img/w.svg' height='65px' width='auto'>RISH</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://www.wrish.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://www.wrish.com/post/"><i class='fa fa-list fa-fw'></i>All Articles</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://www.wrish.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://www.wrish.com/tags/powershell/"><i class='fa fa-terminal fa-fw'></i>Powershell</a>
      
        </li>
      
    </ul>
  </div>
  

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://www.wrish.com/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    

	
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://social.technet.microsoft.com/profile/Shane%20Wright" target="_blank"><i class="fa fa-windows fa-fw"></i>Technet</a>
    </li>
    
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/neossian" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/1111059/neossian" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

  </ul>
</div>

  
<div>
  <div class="pure-menu-center">
    <p>
				
			Language:<a href="http://www.wrish.com/fr/">fr</a> 		
			</p>
				
	
	 <a href="https://www.revolvermaps.com/?target=enlarge&amp;i=5fnnzpxl7dm"><img src="//rf.revolvermaps.com/w/3/s/a/0/40/0/999999/191919/999999/5fnnzpxl7dm.png" alt="Stats" style="border:0;"></a>
  </div>
</div>

  
  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>	
  </div>
  
</div>


  </div>


  <div id="main">


<div class="header">
  <h1>WRISH</h1>
  <h2>A new corner</h2>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/quickly-get-exchange-online-ips/">Powershell get Exchange Online IP addresses (for Firewall rules)</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15  Jun 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/office365">Office365</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/powershell">PowerShell</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>This one-liner will download the Office 365 IP list XML file and extract the IPv4 addresses for EOP and Exchange Online.
</p>
  </p>

  
  <footer>
    <a href="/post/quickly-get-exchange-online-ips/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/powershell-oneliners/">PowerShell Oneliners</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17  May 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/powershell">Powershell</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/activedirectory">ActiveDirectory</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>Just a list of useful oneliners for powershell server and AD management
</p>
  </p>

  
  <footer>
    <a href="/post/powershell-oneliners/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/extracting-objects-from-text-certutil/">Extracting objects from commands that output text</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>30  Apr 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/powershell">Powershell</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/pki">PKI</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>There are many ways to throw a spanner. But if you really must throw it with powershell you&rsquo;ll want it to result in an object.</p>

<p>The versatility of objects can give much to legacy commands that still linger in the Windows administration world. This short tutorial should teach you to turn most legacy commands into one or more commandlets in some concise code.
</p>
  </p>

  
  <footer>
    <a href="/post/extracting-objects-from-text-certutil/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/use-powershell-to-open-svclog-files/">import-svclog to import SVCLOG files</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>18  Apr 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/intune">Intune</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/powershell">PowerShell</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>The Intune connectors dump all their useful information to .svclog files. You can read these files wtih svcTraceViewer.exe which you can get by installing the Windows Communication Foundation SDK.</p>

<p>Don&rsquo;t want to download the SDK just to get one tool? Do not fear - they are just XML. Here is an imperfect script for reading svclog files.
</p>
  </p>

  
  <footer>
    <a href="/post/use-powershell-to-open-svclog-files/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/android-fiddler-hyperv-solution/">HTTPs Inspection on Android with Hyper-V and an Emulator</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16  Apr 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/android">Android</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/intune">Intune</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>I&rsquo;ve been doing some work with Microsoft Intune - specifically around Conditional Access, Azure AD and Intune. There are plenty of guides online for getting a Fiddler trace of HTTPS traffic between Android and a back end, but they all require you to have your Windows Laptop on the same network as your Android device. In a modern corporate network architecture that isn&rsquo;t easy. The Microsoft support team, my customer network, and my conracting company network were all locked down preventing this setup.
</p>
  </p>

  
  <footer>
    <a href="/post/android-fiddler-hyperv-solution/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/errors-with-adfs-rapid-restore-tool/">ADFS Rapid restore tool errors</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15  Mar 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/adfs">ADFS</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Troubleshooting the ADFS Rapid Restore Tool
 import-module ADFSRapidRecreationTool.dll import-module : The specified module 'ADFSRapidRecreationTool.dll' was not loaded because no valid module file was found in any module directory.  Supply the full path to the dll to import it Import-module 'C:\Program Files (x86)\ADFS Rapid Recreation Tool\ADFSRapidRecreationTool.dll'
Backup-ADFS : Failed to connect to the database associated with ADFS You do not have permissions to the ADFS database, if you are using a SQL database make sure your account has access to the database, if WID, make sure you are running as administrator.
  </p>

  
  <footer>
    <a href="/post/errors-with-adfs-rapid-restore-tool/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/assign-ems-licenses-with-dynamic-groups/">Assign EMS licenses to all licensed users with dynamic groups</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10  Mar 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/azuread">AzureAD</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/office365">Office365</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/intune">Intune</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/azure">Azure</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/conditionalaccess">ConditionalAccess</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Azure conditional access provides flexible control over access to Office 365 resources and services based on location/user group membership/device etc. If you set up conditional access rules, any user who doesn&rsquo;t have an Azure AD Premium license will not be affected by them - access is permitted by default!
How to work around this without manually assigning licenses to every user or using a dodgy script? Azure AD has a capability called Dynamic Groups.
  </p>

  
  <footer>
    <a href="/post/assign-ems-licenses-with-dynamic-groups/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/assign-ems-licenses/">Assign EMS licenses to all licensed users</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13  Feb 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/powershell">Powershell</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/office365">Office365</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/intune">Intune</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/azure">Azure</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/conditionalaccess">ConditionalAccess</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>Azure conditional access provides amazingly flexible control over access to Office 365 resources and services based on location/user group membership/device etc. Leveraging it to block access generally requires EMS (Enterprise Mobility + Security) licenses for all users. This short script will assign EMS licenses to all users in your tenant who are licensed but do not have EMS yet.
</p>
  </p>

  
  <footer>
    <a href="/post/assign-ems-licenses/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/cleanup-user-profiles/">User Profile Cleanup</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>23  Jan 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/powershell">Powershell</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/windowsserver">WindowsServer</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Download Cleanup-UserProfiles.ps1
Big environments get messy, lots of users, lots of admins, lots of logging in here and there.
Profiles accumulate, C drive starts to get full, oh the humanity! Fear not humble Admin, on our adventures today we discover how to remove old user profiles with naught but the flick of a WMI method.
The meat and bonse of this function is getting user profiles and deleting them:
$userprofiles = Get-WmiObject -Class Win32_UserProfile $userprofiles[$whichOne].
  </p>

  
  <footer>
    <a href="/post/cleanup-user-profiles/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://www.wrish.com/post/paste-me-an-array/">Paste an array into a variable</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19  Jan 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/powershell">Powershell</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  <p>You&rsquo;ve got a list of values, you want that in an array.</p>

<p>You could copy it to a file, and import it. You could dump it as a string and split it into an array.. or you could <code>Create-ArrayFromPastedText</code>.
</p>
  </p>

  
  <footer>
    <a href="/post/paste-me-an-array/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  

  


<nav class="pagination" role="pagination">
  
  <i class="fa fa-chevron-left"></i>
  
  <span>&nbsp;1 / 3&nbsp;</span>
  
  <a href="/page/2/"><i class="fa fa-chevron-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="http://www.wrish.com/js/ui.js"></script>



</body>
</html>

